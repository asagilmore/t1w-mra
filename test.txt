{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3e6c6eef-053c-43e7-97dd-477835903672",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.26.4\n",
      "  warnings.warn(f\"A NumPy version >={np_minversion} and <{np_maxversion}\"\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "from glob import glob\n",
    "import nibabel as nib\n",
    "from nibabel.processing import resample_from_to\n",
    "import matplotlib.pyplot as plt\n",
    "import os\n",
    "import os.path as op\n",
    "from sklearn.model_selection import train_test_split\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "c1251b40-b47a-4117-8792-189c1df43f31",
   "metadata": {},
   "outputs": [],
   "source": [
    "def subject_id_from_fname(fname):\n",
    "    return op.split(fname)[1].split(\"-\")[:2]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "4180770d-0d98-4180-b483-ac01d99e6ad0",
   "metadata": {},
   "outputs": [],
   "source": [
    "def png_slice(slice_data, fname):\n",
    "    fig, ax = plt.subplots()\n",
    "    ax.matshow(slice_data, cmap=\"gray\")\n",
    "    ax.axis(\"off\")\n",
    "    fig.savefig(fname)\n",
    "    plt.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ad1e13dc-c54b-494b-b721-8b2e4a63a1c4",
   "metadata": {},
   "outputs": [],
   "source": [
    "T1_list = glob(\"/home/jovyan/work/data/mri/data/raw/T1/*.nii.gz\")\n",
    "MRA_list = glob(\"/home/jovyan/work/data/mri/data/raw/MRA/*.nii.gz\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "2c899586-a7a6-4ac4-98bf-23f82e4fcbb4",
   "metadata": {},
   "outputs": [],
   "source": [
    "T1_files = {subject_id_from_fname(xx)[0]: (subject_id_from_fname(xx)[1], xx) for xx in T1_list}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "c2fa2272-d510-4546-9d22-0d374187283a",
   "metadata": {},
   "outputs": [],
   "source": [
    "MRA_files = {subject_id_from_fname(xx)[0]: (subject_id_from_fname(xx)[1], xx) for xx in MRA_list}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "6a33bcd9-4cef-4b9a-bad5-85d94e1c8e71",
   "metadata": {},
   "outputs": [],
   "source": [
    "# There are less subjects with MRA, so we will use only those: \n",
    "sub_site_all = np.array([(i[0], i[1][0]) for i in MRA_files.items()])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "203334a9-4d98-4d38-85d3-c31a01d22aee",
   "metadata": {},
   "outputs": [],
   "source": [
    "train, test = train_test_split(sub_site_all, stratify=sub_site_all[:, 1], random_state=1)\n",
    "test, valid = train_test_split(test, stratify=test[:, 1], train_size=0.5, random_state=2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "0760b03c-83f5-4da7-9c25-bd51ba3c8d2d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "((427, 2), (71, 2), (72, 2))"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.shape, test.shape, valid.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "8367dcd9-ff37-4f04-870f-e7689af86d88",
   "metadata": {},
   "outputs": [],
   "source": [
    "train_subs = train[:, 0]\n",
    "test_subs = test[:, 0]\n",
    "valid_subs = valid[:, 0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "9f161de1-4503-4341-ab65-5b28eede1050",
   "metadata": {},
   "outputs": [],
   "source": [
    "def generate_subject_png(ii,subject_id, subset):\n",
    "    fnames = []\n",
    "    MRA_img = nib.load(MRA_files[subject_id][1])\n",
    "    print(ii, subset, subject_id)\n",
    "    if not op.exists(f\"data/{subset}/{subject_id}/sub-{subject_id}_sl-{MRA_img.shape[-1]-1:04d}_t1w.png\"):\n",
    "        os.makedirs(f\"data/{subset}/{subject_id}/\", exist_ok=True)\n",
    "        try: \n",
    "            T1_img = nib.load(T1_files[subject_id][1])\n",
    "            MRA_data = MRA_img.get_fdata()\n",
    "            T1_img_resampled = resample_from_to(T1_img, (MRA_img.shape, MRA_img.affine))\n",
    "            T1_data = T1_img_resampled.get_fdata()            \n",
    "            for sl in range(MRA_data.shape[-1]): \n",
    "                MRA_fname = f\"/home/jovyan/work/data/arokem/mri2mra/data/{subset}/{subject_id}/sub-{subject_id}_sl-{sl:04d}_mra.png\"\n",
    "                T1w_fname = f\"/home/jovyan/work/data/arokem/mri2mra/data/{subset}/{subject_id}/sub-{subject_id}_sl-{sl:04d}_t1w.png\"\n",
    "                MRA_sl = MRA_data[:, :, sl]\n",
    "                T1w_sl = T1_data[:, :, sl]\n",
    "                png_slice(MRA_sl, MRA_fname)\n",
    "                png_slice(T1w_sl, T1w_fname)\n",
    "                fnames.append([T1w_fname, MRA_fname])\n",
    "        except: \n",
    "            print(\"There was some problem here\")\n",
    "    else: \n",
    "        for sl in range(MRA_img.shape[-1]): \n",
    "            MRA_fname = f\"/home/jovyan/work/data/arokem/mri2mra/data/{subset}/{subject_id}/sub-{subject_id}_sl-{sl:04d}_mra.png\"\n",
    "            T1w_fname = f\"/home/jovyan/work/data/arokem/mri2mra/data/{subset}/{subject_id}/sub-{subject_id}_sl-{sl:04d}_t1w.png\"\n",
    "            fnames.append([T1w_fname, MRA_fname])\n",
    "        \n",
    "    return pd.DataFrame(data=fnames, columns=[\"image\", \"label\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "00eec112-9cc9-4aa3-b3c6-36a8bc80faa4",
   "metadata": {},
   "outputs": [],
   "source": [
    "def generate_subset_png(sub_list, subset):\n",
    "    fnames = generate_subject_png(0, sub_list[0], subset)\n",
    "    for ii, subjid in enumerate(sub_list[1:]):\n",
    "        fnames = pd.concat([fnames, generate_subject_png(ii, subjid, subset)])\n",
    "    fnames.to_csv(f\"{subset}.csv\", index=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "d7f947f7-4494-451a-bd50-a6a2a99b5363",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0 train IXI268\n",
      "0 train IXI102\n",
      "1 train IXI257\n",
      "2 train IXI495\n",
      "3 train IXI204\n",
      "4 train IXI067\n",
      "5 train IXI237\n",
      "6 train IXI613\n",
      "7 train IXI340\n",
      "8 train IXI488\n",
      "9 train IXI080\n",
      "10 train IXI575\n",
      "11 train IXI109\n",
      "12 train IXI275\n",
      "13 train IXI464\n",
      "14 train IXI161\n",
      "15 train IXI536\n",
      "16 train IXI440\n",
      "17 train IXI511\n",
      "18 train IXI586\n",
      "19 train IXI291\n",
      "20 train IXI046\n",
      "21 train IXI566\n",
      "22 train IXI336\n",
      "23 train IXI115\n",
      "24 train IXI463\n",
      "25 train IXI200\n",
      "26 train IXI603\n",
      "27 train IXI254\n",
      "28 train IXI505\n",
      "29 train IXI274\n",
      "30 train IXI176\n",
      "31 train IXI294\n",
      "32 train IXI432\n",
      "33 train IXI036\n",
      "34 train IXI537\n",
      "35 train IXI479\n",
      "36 train IXI469\n",
      "37 train IXI486\n",
      "38 train IXI402\n",
      "39 train IXI377\n",
      "40 train IXI071\n",
      "41 train IXI609\n",
      "42 train IXI459\n",
      "43 train IXI229\n",
      "44 train IXI188\n",
      "45 train IXI110\n",
      "46 train IXI332\n",
      "47 train IXI015\n",
      "48 train IXI595\n",
      "49 train IXI033\n",
      "50 train IXI445\n",
      "51 train IXI342\n",
      "52 train IXI231\n",
      "53 train IXI605\n",
      "54 train IXI337\n",
      "55 train IXI334\n",
      "56 train IXI038\n",
      "57 train IXI241\n",
      "58 train IXI597\n",
      "59 train IXI600\n",
      "60 train IXI216\n",
      "61 train IXI644\n",
      "62 train IXI002\n",
      "63 train IXI177\n",
      "64 train IXI456\n",
      "65 train IXI277\n",
      "66 train IXI631\n",
      "67 train IXI066\n",
      "68 train IXI197\n",
      "69 train IXI219\n",
      "70 train IXI077\n",
      "71 train IXI278\n",
      "72 train IXI021\n",
      "73 train IXI319\n",
      "74 train IXI531\n",
      "75 train IXI386\n",
      "76 train IXI045\n",
      "77 train IXI397\n",
      "78 train IXI500\n",
      "79 train IXI344\n",
      "80 train IXI401\n",
      "81 train IXI491\n",
      "82 train IXI256\n",
      "83 train IXI263\n",
      "84 train IXI270\n",
      "85 train IXI635\n",
      "86 train IXI163\n",
      "87 train IXI392\n",
      "88 train IXI293\n",
      "89 train IXI549\n",
      "90 train IXI192\n",
      "91 train IXI639\n",
      "92 train IXI300\n",
      "93 train IXI217\n",
      "94 train IXI360\n",
      "95 train IXI246\n",
      "96 train IXI029\n",
      "97 train IXI044\n",
      "98 train IXI562\n",
      "99 train IXI072\n",
      "100 train IXI055\n",
      "101 train IXI454\n",
      "102 train IXI455\n",
      "103 train IXI265\n",
      "104 train IXI264\n",
      "105 train IXI389\n",
      "106 train IXI361\n",
      "107 train IXI411\n",
      "108 train IXI587\n",
      "109 train IXI113\n",
      "110 train IXI320\n",
      "111 train IXI506\n",
      "112 train IXI078\n",
      "113 train IXI150\n",
      "114 train IXI393\n",
      "115 train IXI345\n",
      "116 train IXI470\n",
      "117 train IXI227\n",
      "118 train IXI341\n",
      "119 train IXI141\n",
      "120 train IXI399\n",
      "121 train IXI240\n",
      "122 train IXI100\n",
      "123 train IXI359\n",
      "124 train IXI064\n",
      "125 train IXI136\n",
      "126 train IXI279\n",
      "127 train IXI473\n",
      "128 train IXI375\n",
      "129 train IXI534\n",
      "130 train IXI541\n",
      "131 train IXI524\n",
      "132 train IXI381\n",
      "133 train IXI642\n",
      "134 train IXI156\n",
      "135 train IXI165\n",
      "136 train IXI023\n",
      "137 train IXI020\n",
      "138 train IXI415\n",
      "139 train IXI054\n",
      "140 train IXI522\n",
      "141 train IXI184\n",
      "142 train IXI210\n",
      "143 train IXI250\n",
      "144 train IXI111\n",
      "145 train IXI135\n",
      "146 train IXI090\n",
      "147 train IXI503\n",
      "148 train IXI050\n",
      "149 train IXI517\n",
      "150 train IXI622\n",
      "151 train IXI372\n",
      "152 train IXI551\n",
      "153 train IXI556\n",
      "154 train IXI094\n",
      "155 train IXI128\n",
      "156 train IXI223\n",
      "157 train IXI307\n",
      "158 train IXI329\n",
      "159 train IXI480\n",
      "160 train IXI089\n",
      "161 train IXI542\n",
      "162 train IXI295\n",
      "163 train IXI101\n",
      "164 train IXI627\n",
      "165 train IXI573\n",
      "166 train IXI138\n",
      "167 train IXI384\n",
      "168 train IXI186\n",
      "169 train IXI244\n",
      "170 train IXI474\n",
      "171 train IXI019\n",
      "172 train IXI151\n",
      "173 train IXI306\n",
      "174 train IXI369\n",
      "175 train IXI610\n",
      "176 train IXI662\n",
      "177 train IXI193\n",
      "178 train IXI525\n",
      "179 train IXI450\n",
      "180 train IXI289\n",
      "181 train IXI027\n",
      "182 train IXI052\n",
      "183 train IXI419\n",
      "184 train IXI212\n",
      "185 train IXI024\n",
      "186 train IXI569\n",
      "187 train IXI465\n",
      "188 train IXI174\n",
      "189 train IXI144\n",
      "190 train IXI478\n",
      "191 train IXI395\n",
      "192 train IXI166\n",
      "193 train IXI153\n",
      "194 train IXI106\n",
      "195 train IXI049\n",
      "196 train IXI563\n",
      "197 train IXI298\n",
      "198 train IXI439\n",
      "199 train IXI230\n",
      "200 train IXI572\n",
      "201 train IXI436\n",
      "202 train IXI103\n",
      "203 train IXI638\n",
      "204 train IXI387\n",
      "205 train IXI313\n",
      "206 train IXI437\n",
      "207 train IXI326\n",
      "208 train IXI266\n",
      "209 train IXI554\n",
      "210 train IXI376\n",
      "211 train IXI267\n",
      "212 train IXI636\n",
      "213 train IXI418\n",
      "214 train IXI484\n",
      "215 train IXI477\n",
      "216 train IXI498\n",
      "217 train IXI458\n",
      "218 train IXI508\n",
      "219 train IXI185\n",
      "220 train IXI646\n",
      "221 train IXI448\n",
      "222 train IXI601\n",
      "223 train IXI379\n",
      "224 train IXI086\n",
      "225 train IXI623\n",
      "226 train IXI099\n",
      "227 train IXI641\n",
      "228 train IXI070\n",
      "229 train IXI261\n",
      "230 train IXI051\n",
      "231 train IXI451\n",
      "232 train IXI584\n",
      "233 train IXI519\n",
      "234 train IXI312\n",
      "235 train IXI178\n",
      "236 train IXI158\n",
      "237 train IXI169\n",
      "238 train IXI081\n",
      "239 train IXI510\n",
      "240 train IXI357\n",
      "241 train IXI057\n",
      "242 train IXI017\n",
      "243 train IXI574\n",
      "244 train IXI221\n",
      "245 train IXI512\n",
      "246 train IXI490\n",
      "247 train IXI039\n",
      "248 train IXI403\n",
      "249 train IXI333\n",
      "250 train IXI592\n",
      "251 train IXI460\n",
      "252 train IXI317\n",
      "253 train IXI538\n",
      "254 train IXI382\n",
      "255 train IXI559\n",
      "256 train IXI259\n",
      "257 train IXI251\n",
      "258 train IXI560\n",
      "259 train IXI533\n",
      "260 train IXI170\n",
      "261 train IXI061\n",
      "262 train IXI224\n",
      "263 train IXI253\n",
      "264 train IXI209\n",
      "265 train IXI252\n",
      "266 train IXI311\n",
      "267 train IXI444\n",
      "268 train IXI167\n",
      "269 train IXI260\n",
      "270 train IXI425\n",
      "271 train IXI053\n",
      "272 train IXI043\n",
      "273 train IXI335\n",
      "274 train IXI378\n",
      "275 train IXI410\n",
      "276 train IXI447\n",
      "277 train IXI076\n",
      "278 train IXI299\n",
      "279 train IXI214\n",
      "280 train IXI173\n",
      "281 train IXI501\n",
      "282 train IXI160\n",
      "283 train IXI546\n",
      "284 train IXI417\n",
      "285 train IXI028\n",
      "286 train IXI041\n",
      "287 train IXI194\n",
      "288 train IXI358\n",
      "289 train IXI593\n",
      "290 train IXI408\n",
      "291 train IXI653\n",
      "292 train IXI105\n",
      "293 train IXI422\n",
      "294 train IXI164\n",
      "295 train IXI446\n",
      "296 train IXI146\n",
      "297 train IXI310\n",
      "298 train IXI555\n",
      "299 train IXI321\n",
      "300 train IXI461\n",
      "301 train IXI088\n",
      "302 train IXI096\n",
      "303 train IXI588\n",
      "304 train IXI157\n",
      "305 train IXI426\n",
      "306 train IXI137\n",
      "307 train IXI175\n",
      "308 train IXI598\n",
      "309 train IXI354\n",
      "310 train IXI181\n",
      "311 train IXI632\n",
      "312 train IXI594\n",
      "313 train IXI553\n",
      "314 train IXI558\n",
      "315 train IXI629\n",
      "316 train IXI467\n",
      "317 train IXI303\n",
      "318 train IXI475\n",
      "319 train IXI056\n",
      "320 train IXI016\n",
      "321 train IXI582\n",
      "322 train IXI504\n",
      "323 train IXI092\n",
      "324 train IXI262\n",
      "325 train IXI284\n",
      "326 train IXI084\n",
      "327 train IXI494\n",
      "328 train IXI412\n",
      "329 train IXI168\n",
      "330 train IXI234\n",
      "331 train IXI074\n",
      "332 train IXI199\n",
      "333 train IXI131\n",
      "334 train IXI496\n",
      "335 train IXI276\n",
      "336 train IXI331\n",
      "337 train IXI202\n",
      "338 train IXI180\n",
      "339 train IXI535\n",
      "340 train IXI612\n",
      "341 train IXI117\n",
      "342 train IXI012\n",
      "343 train IXI625\n",
      "344 train IXI407\n",
      "345 train IXI453\n",
      "346 train IXI159\n",
      "347 train IXI085\n",
      "348 train IXI452\n",
      "349 train IXI396\n",
      "350 train IXI195\n",
      "351 train IXI428\n",
      "352 train IXI304\n",
      "353 train IXI091\n",
      "354 train IXI371\n",
      "There was some problem here\n",
      "355 train IXI552\n",
      "356 train IXI087\n",
      "357 train IXI226\n",
      "358 train IXI373\n",
      "359 train IXI065\n",
      "360 train IXI218\n",
      "361 train IXI034\n",
      "362 train IXI492\n",
      "363 train IXI249\n",
      "364 train IXI060\n",
      "365 train IXI154\n",
      "366 train IXI367\n",
      "367 train IXI201\n",
      "368 train IXI108\n",
      "369 train IXI547\n",
      "370 train IXI383\n",
      "371 train IXI129\n",
      "372 train IXI083\n",
      "373 train IXI247\n",
      "374 train IXI258\n",
      "375 train IXI324\n",
      "376 train IXI457\n",
      "377 train IXI608\n",
      "378 train IXI280\n",
      "379 train IXI368\n",
      "380 train IXI487\n",
      "381 train IXI127\n",
      "382 train IXI434\n",
      "383 train IXI365\n",
      "384 train IXI617\n",
      "385 train IXI433\n",
      "386 train IXI591\n",
      "387 train IXI132\n",
      "388 train IXI353\n",
      "389 train IXI442\n",
      "390 train IXI526\n",
      "391 train IXI179\n",
      "392 train IXI364\n",
      "393 train IXI398\n",
      "394 train IXI550\n",
      "395 train IXI114\n",
      "396 train IXI211\n",
      "397 train IXI571\n",
      "398 train IXI580\n",
      "There was some problem here\n",
      "399 train IXI198\n",
      "400 train IXI532\n",
      "401 train IXI640\n",
      "402 train IXI287\n",
      "403 train IXI502\n",
      "404 train IXI330\n",
      "405 train IXI449\n",
      "406 train IXI356\n",
      "407 train IXI059\n",
      "408 train IXI022\n",
      "409 train IXI568\n",
      "410 train IXI290\n",
      "411 train IXI579\n",
      "412 train IXI416\n",
      "413 train IXI183\n",
      "414 train IXI388\n",
      "415 train IXI406\n",
      "416 train IXI095\n",
      "417 train IXI481\n",
      "418 train IXI035\n",
      "419 train IXI119\n",
      "420 train IXI523\n",
      "421 train IXI097\n",
      "422 train IXI485\n",
      "423 train IXI423\n",
      "424 train IXI576\n",
      "425 train IXI118\n",
      "0 test IXI441\n",
      "0 test IXI476\n",
      "1 test IXI606\n",
      "2 test IXI120\n",
      "3 test IXI585\n",
      "4 test IXI248\n",
      "5 test IXI315\n",
      "6 test IXI196\n",
      "7 test IXI548\n",
      "8 test IXI208\n",
      "9 test IXI239\n",
      "10 test IXI618\n",
      "11 test IXI037\n",
      "12 test IXI493\n",
      "13 test IXI073\n",
      "14 test IXI063\n",
      "15 test IXI222\n",
      "16 test IXI031\n",
      "17 test IXI232\n",
      "18 test IXI292\n",
      "19 test IXI661\n",
      "20 test IXI543\n",
      "21 test IXI123\n",
      "22 test IXI577\n",
      "23 test IXI162\n",
      "24 test IXI626\n",
      "25 test IXI630\n",
      "26 test IXI499\n",
      "27 test IXI191\n",
      "28 test IXI400\n",
      "29 test IXI528\n",
      "30 test IXI126\n",
      "31 test IXI069\n",
      "32 test IXI236\n",
      "33 test IXI621\n",
      "34 test IXI107\n",
      "35 test IXI489\n",
      "36 test IXI483\n",
      "37 test IXI515\n",
      "38 test IXI318\n",
      "39 test IXI527\n",
      "40 test IXI139\n",
      "41 test IXI482\n",
      "42 test IXI544\n",
      "43 test IXI013\n",
      "44 test IXI328\n",
      "45 test IXI130\n",
      "46 test IXI058\n",
      "47 test IXI122\n",
      "48 test IXI322\n",
      "49 test IXI025\n",
      "50 test IXI611\n",
      "51 test IXI305\n",
      "52 test IXI104\n",
      "53 test IXI134\n",
      "54 test IXI062\n",
      "55 test IXI143\n",
      "56 test IXI242\n",
      "57 test IXI296\n",
      "58 test IXI207\n",
      "59 test IXI431\n",
      "60 test IXI189\n",
      "61 test IXI316\n",
      "62 test IXI390\n",
      "63 test IXI413\n",
      "64 test IXI286\n",
      "65 test IXI596\n",
      "66 test IXI567\n",
      "67 test IXI643\n",
      "68 test IXI121\n",
      "69 test IXI404\n",
      "0 valid IXI238\n",
      "0 valid IXI140\n",
      "1 valid IXI561\n",
      "2 valid IXI414\n",
      "3 valid IXI269\n",
      "4 valid IXI420\n",
      "5 valid IXI351\n",
      "6 valid IXI424\n",
      "7 valid IXI521\n",
      "8 valid IXI282\n",
      "9 valid IXI468\n",
      "10 valid IXI079\n",
      "11 valid IXI648\n",
      "12 valid IXI370\n",
      "13 valid IXI362\n",
      "14 valid IXI285\n",
      "15 valid IXI435\n",
      "16 valid IXI539\n",
      "17 valid IXI093\n",
      "18 valid IXI385\n",
      "19 valid IXI338\n",
      "20 valid IXI497\n",
      "21 valid IXI429\n",
      "22 valid IXI637\n",
      "23 valid IXI098\n",
      "24 valid IXI619\n",
      "25 valid IXI026\n",
      "26 valid IXI308\n",
      "27 valid IXI048\n",
      "28 valid IXI614\n",
      "29 valid IXI347\n",
      "30 valid IXI142\n",
      "31 valid IXI565\n",
      "32 valid IXI427\n",
      "33 valid IXI068\n",
      "34 valid IXI394\n",
      "35 valid IXI391\n",
      "36 valid IXI228\n",
      "37 valid IXI350\n",
      "38 valid IXI430\n",
      "39 valid IXI145\n",
      "40 valid IXI148\n",
      "41 valid IXI507\n",
      "42 valid IXI288\n",
      "43 valid IXI205\n",
      "44 valid IXI652\n",
      "45 valid IXI030\n",
      "46 valid IXI518\n",
      "47 valid IXI405\n",
      "48 valid IXI634\n",
      "49 valid IXI042\n",
      "50 valid IXI633\n",
      "51 valid IXI040\n",
      "52 valid IXI348\n",
      "53 valid IXI172\n",
      "54 valid IXI206\n",
      "55 valid IXI075\n",
      "56 valid IXI616\n",
      "57 valid IXI443\n",
      "58 valid IXI327\n",
      "59 valid IXI607\n",
      "60 valid IXI438\n",
      "61 valid IXI462\n",
      "62 valid IXI599\n",
      "63 valid IXI409\n",
      "64 valid IXI516\n",
      "65 valid IXI363\n",
      "66 valid IXI314\n",
      "67 valid IXI325\n",
      "68 valid IXI380\n",
      "69 valid IXI112\n",
      "70 valid IXI297\n"
     ]
    }
   ],
   "source": [
    "train_df = generate_subset_png(train_subs, \"train\")\n",
    "test_df = generate_subset_png(test_subs, \"test\")\n",
    "valid_df = generate_subset_png(valid_subs, \"valid\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "4c6d1b01-d6ee-4db1-ad99-69922f3340de",
   "metadata": {},
   "outputs": [],
   "source": [
    "subject_id = train_subs[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "b84a8e90-8a1e-4ac0-832d-a5c2075584cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "MRA_img = nib.load(MRA_files[subject_id][1])\n",
    "subset = \"train\""
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}